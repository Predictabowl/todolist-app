<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head th:replace="fragments/layouts :: app-common-header(~{::title})">
	<title>Projects</title>
</head>
<body>
	<div th:replace="fragments/layouts :: app-layout(${user.username}, ~{::#content}, ${projects})">
		<div id="content">
			<div th:if="${activeProject != null}" id="active-project-section">
				<h1 class="title" th:text="${activeProject.name}"></h1>
				<ul id="tasks-list">
					<li class="box" th:each="task : ${tasks}">
						<p>
							<span class="title is-5" th:text="${task.name}"></span>
						</p>
						<p th:text="${task.description}"></p>
					</li>
				</ul>
				
				<div class="mt-5">
					<div id="add-task-link">
						<a href="#">
							<span class="icon">
								<em class="fas fa-plus"></em>
							</span>
							<span
								th:text="#{add.task}">
							</span>
						</a>
					</div>
					<div class="box" id="new-task-form-container" style="display:none;">
						<form th:action="@{/project/{id}/task/new (id=${activeProject.id})}" 
								name="new-task-form" method="post"
								th:object="${newTaskWebDto}">
							<div class="field" th:insert="fragments/commons::inputWithField('name', 'Name', 'text')"></div>
							<div class="field">
								<textarea class="textarea" type="text" placeholder="Description" name="description" ></textarea>
								<label class="help is-danger"	th:if="${#fields.hasErrors('description')}" th:id="'input-helper-description'" th:errors="*{'description'}"></label>
							</div>
							<div class="control">
								<button class="button is-success is-rounded" type="submit" name="submit-button" th:text="#{add}"></button>
								<button class="button is-rounded" type="button" name="cancel-button" id="close-new-task-form" th:text="#{cancel}"></button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<script type="text/javascript">
		$("#add-task-link, #close-new-task-form").click(function(){
			$("#add-task-link").toggle();
			$("#new-task-form-container").toggle();
		})
	</script>

</body>
</html>